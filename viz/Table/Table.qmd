---
title: "Coffee- Pretty Tables"
author: "Karol Orozco"
date: today
image: "coffee.png"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(ggplot2)
library(DT)
library(gt)
library(gtExtras)
library(dplyr)



coffee <- read.csv("https://raw.githubusercontent.com/karolo89/karolo_website/main/data/2023/arabica_data_cleaned.csv")%>%
    rename_all(tolower) %>%
    select(country.of.origin, aroma, flavor, acidity, sweetness)%>%
  rename_at("country.of.origin", ~"Country")

coffee <- distinct(coffee)
summary(coffee)%>% 
na.omit()

coffee$acidity <- as.numeric(coffee$acidity)
coffee$sweetness<- as.numeric(coffee$sweetness)



coffee <- coffee %>%
  mutate_if(is.numeric, round, digits = 3)

coffee <- coffee %>%
  group_by(Country)%>% 
  summarize(Avg_aroma= median(aroma),
            Avg_flavor= median(flavor),
            Avg_acidity =  median(acidity),
            Avg_sweetness = median(sweetness))

coffee <-  subset(coffee, Country != "")
```

# Table with DT

```{r}

  datatable(coffee, 
            caption = htmltools::tags$caption(style = "caption-side: bottom; text-align: center;",
    htmltools::strong("Source: Coffee Quality Institute (CQI), January 2018. | By: Karol Orozco" )),
    editable = "cell", 
    extensions = c("Scroller","Buttons"), 
    options = list(deferRender = TRUE, 
                   scrollY = 400, 
                   scroller = TRUE,
                   dom = "Bfrtip", 
                   buttons = c("copy", "csv", "excel", "pdf", "print")))

          
```

## Gt and gtExtra

```{r}

library(ggimage)

coffee_tabble <- coffee %>%
  filter(Country !="Cote d?Ivoire")%>%
  mutate(flag = case_when(
   str_detect(Country,"Burundi") ~ "https://raw.githubusercontent.com/karolo89/karolo_website/main/viz/Table/Flag_of_Burundi.svg.png",
     str_detect(Country, "Brazil") ~ "https://raw.githubusercontent.com/karolo89/karolo_website/main/viz/Table/2560px-Flag_of_Brazil.svg.png",
    str_detect(Country,"China") ~ "https://raw.githubusercontent.com/karolo89/karolo_website/main/viz/Table/Flag_of_China.png",
    str_detect(Country,"Colombia") ~ "https://raw.githubusercontent.com/karolo89/karolo_website/main/viz/Table/Flag_of_Colombia.png",
    str_detect(Country,"Costa Rica") ~ "https://raw.githubusercontent.com/karolo89/karolo_website/main/viz/Table/Flag_of_Costa_Rica.svg.png",
    str_detect(Country,"Cote d'Ivoire") ~ "https://raw.githubusercontent.com/karolo89/karolo_website/main/viz/Table/Flag_of_C%C3%B4te_d'Ivoire.svg.png",
    str_detect(Country,"Ecuador") ~ "https://raw.githubusercontent.com/karolo89/karolo_website/main/viz/Table/Flag_of_Ecuador.svg.png",
     str_detect(Country, "El Salvador" )~ "https://raw.githubusercontent.com/karolo89/karolo_website/main/viz/Table/Flag_of_El_Salvador.svg.png",
    str_detect(Country,"Ethiopia") ~ "https://raw.githubusercontent.com/karolo89/karolo_website/main/viz/Table/Flag_of_Ethiopia.svg.png",
    str_detect(Country,"Guatemala") ~ "https://raw.githubusercontent.com/karolo89/karolo_website/main/viz/Table/Flag_of_Guatemala.svg.png"))%>%
  head(n =9)%>%
  select(Country, flag, Avg_acidity, Avg_aroma, Avg_flavor, Avg_sweetness)


```

```{r}
coffee_tabble%>%
  gt()%>%
  tab_header(
    title = "Arabica Coffee Attributes by Country")%>%
tab_style(
    style = list(
      cell_text(font=google_font(
        #name = "Roboto Condensed"
        name = "Playfair Display"), weight='800',
        align = "center",color='#6F4E37')),
    locations = cells_title(groups = "title"))%>%
  gtExtras::gt_theme_nytimes()%>% 
  gtExtras::gt_img_rows(columns = flag, height = 15)

```