---
title: "Coffee- Pretty Tables"
author: "Karol Orozco"
date: today
image: "coffee.png"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(ggplot2)
library(DT)
library(gt)
library(gtExtras)
library(dplyr)


coffee <- read.csv("https://raw.githubusercontent.com/karolo89/karolo_website/main/data/2023/arabica_data_cleaned.csv")%>%
    rename_all(tolower) %>%
    select(country.of.origin, aroma, flavor, acidity, sweetness)

coffee <- distinct(coffee)
summary(coffee)%>% 
na.omit()

coffee$acidity <- as.numeric(coffee$acidity)
coffee$sweetness<- as.numeric(coffee$sweetness)



coffee <- coffee %>%
  mutate_if(is.numeric, round, digits = 3)

coffee <- coffee %>%
  group_by(country.of.origin)%>% 
  summarize(Avg_aroma= median(aroma),
            Avg_flavor= median(flavor),
            Avg_acidity =  median(acidity),
            Avg_sweetness = median(sweetness))

coffee <-  subset(coffee, country.of.origin != "")
```

# Table with DT

```{r}

  datatable(coffee, 
            colnames = c("Country" = "country.of.origin"),
            caption = htmltools::tags$caption(style = "caption-side: bottom; text-align: center;",
    htmltools::strong("Source: Coffee Quality Institute (CQI), January 2018. | By: Karol Orozco" )),
    editable = "cell", 
    extensions = c("Scroller","Buttons"), 
    options = list(deferRender = TRUE, 
                   scrollY = 400, 
                   scroller = TRUE,
                   dom = "Bfrtip", 
                   buttons = c("copy", "csv", "excel", "pdf", "print")))

          
```

## Gt and gtExtra

```{r}

library(ggimage)

coffee_tabble <- coffee %>%
  filter(country.of.origin !="Cote d?Ivoire")%>%
  mutate(flag = case_when(
   str_detect(country.of.origin,"Burundi") ~ "https://raw.githubusercontent.com/karolo89/karolo_website/main/viz/Table/Flag_of_Burundi.svg.png",
     str_detect(country.of.origin, "Brazil") ~ "https://raw.githubusercontent.com/karolo89/karolo_website/main/viz/Table/2560px-Flag_of_Brazil.svg.png",
    str_detect(country.of.origin,"China") ~ "https://raw.githubusercontent.com/karolo89/karolo_website/main/viz/Table/Flag_of_China.png",
    str_detect(country.of.origin,"Colombia") ~ "https://raw.githubusercontent.com/karolo89/karolo_website/main/viz/Table/Flag_of_Colombia.png",
    str_detect(country.of.origin,"Costa Rica") ~ "https://raw.githubusercontent.com/karolo89/karolo_website/main/viz/Table/Flag_of_Costa_Rica.svg.png",
    str_detect(country.of.origin,"Cote d'Ivoire") ~ "https://raw.githubusercontent.com/karolo89/karolo_website/main/viz/Table/Flag_of_C%C3%B4te_d'Ivoire.svg.png",
    str_detect(country.of.origin,"Ecuador") ~ "https://raw.githubusercontent.com/karolo89/karolo_website/main/viz/Table/Flag_of_Ecuador.svg.png",
     str_detect(country.of.origin, "El Salvador" )~ "https://raw.githubusercontent.com/karolo89/karolo_website/main/viz/Table/Flag_of_El_Salvador.svg.png",
    str_detect(country.of.origin,"Ethiopia") ~ "https://raw.githubusercontent.com/karolo89/karolo_website/main/viz/Table/Flag_of_Ethiopia.svg.png",
    str_detect(country.of.origin,"Guatemala") ~ "https://raw.githubusercontent.com/karolo89/karolo_website/main/viz/Table/Flag_of_Guatemala.svg.png"))%>%
  head(n =9)%>%
  select(country.of.origin, flag, Avg_acidity, Avg_aroma, Avg_flavor, Avg_sweetness)


```

```{r}
coffee_tabble%>%
  gt()%>%
  tab_header(
    title = "Arabica Coffee Attributes by Country")%>%
  gtExtras::gt_theme_nytimes()%>% 
  gtExtras::gt_img_rows(columns = flag, height = 20)

```

