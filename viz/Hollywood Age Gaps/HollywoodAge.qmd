---
title: "Hollywood Age Gaps"
author: "Karol Orozco"
date: today
image: "tt_logo.png"
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(warning=FALSE, message=FALSE)

library(tidyverse)
library(dplyr)
library(tidytuesdayR)
library(here)
library(showtext)
library(janitor)

library(camcorder)
library(ggtext)
library(glue)
library(patchwork)
library(gghighlight)


age_gaps <- read.csv("https://raw.githubusercontent.com/karolo89/karolo_website/main/data/2023/2023-02-14/age_gaps.csv")


```

```{r}
summary(age_gaps)
```

```{r}
# data wrangling


 age_gaps |> 
  mutate(rel_type = case_when(
    (character_1_gender == "woman" & character_2_gender == "man") ~ "Older Woman, Younger Man",
    (character_1_gender == "man" & character_2_gender == "woman") ~ "Older Man, Younger Woman",
    (character_1_gender == "woman" & character_2_gender == "woman") ~ "Both Women",
    (character_1_gender == "man" & character_2_gender == "man") ~ "Both Men" 
  )) |> 
  select(release_year, age_difference, rel_type) 

 ggplot(data = plot_data,
       mapping = aes(x = release_year,
                     y = age_difference)) +
  geom_point(colour = alpha("#508080", 0.5)) +
  geom_smooth(colour = "#E30B5C", se = FALSE) +
  labs(y = "Age gap (years)") +
  theme_minimal()
 
 # faceted plot
ggplot(data = plot_data,
       mapping = aes(x = release_year,
                     y = age_difference, 
                     colour = rel_type)) +
  geom_point(colour = alpha("#E30B5C", 0.5),
             size = 0.3) +
  gghighlight(use_direct_label = F) +
  facet_wrap(~rel_type, ncol = 2, nrow = 2,
             labeller = labeller(rel_type = label_wrap_gen(18))) +
  labs(y = "Age gap (years)") +
  theme_minimal()



```



## Reference

The data this week comes from Hollywood Age Gap via Data Is Plural.

Thomas Mock (2022). Tidy Tuesday: A weekly data project aimed at the R ecosystem.[GitHub](https://github.com/rfordatascience/tidytuesday)
