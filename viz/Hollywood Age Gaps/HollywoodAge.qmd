---
title: "Hollywood Age Gaps"
author: "Karol Orozco"
date: today
image: "tt_logo.png"
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(warning=FALSE, message=FALSE)

library(tidyverse)
library(dplyr)
library(tidytuesdayR)
library(here)
library(ggplot2)
library(janitor)
library(dplyr)


age_gaps <- read.csv("https://raw.githubusercontent.com/karolo89/karolo_website/main/data/2023/2023-02-14/age_gaps.csv")
```



```{r}
df <- age_gaps %>%
    arrange(release_year) %>% 
    mutate(decade = paste0((release_year - 1) %/% 10 * 10, "'s")) %>% 
    mutate(movie_name = fct_reorder(movie_name, release_year, .desc = TRUE)) 

df_mean <- df%>%
group_by(decade) %>% 
    summarise_at(vars(age_difference), list(mean_age_diff = mean)) %>% 
    ungroup()

viz_df <- df %>% 
    left_join(y = df_mean, by = "decade") %>% 
    select(movie_name, release_year, age_difference, mean_age_diff, decade) %>% 
    mutate(age_category = ifelse(age_difference > mean_age_diff, "Above Average", "Below Average")) %>% 
    dplyr::mutate_if(is.numeric, round, 2) 


head(viz_df)
```






## Reference

The data this week comes from Hollywood Age Gap via Data Is Plural.

Thomas Mock (2022). Tidy Tuesday: A weekly data project aimed at the R ecosystem.[GitHub](https://github.com/rfordatascience/tidytuesday)
