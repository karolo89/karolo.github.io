{
  "hash": "3808f5f4922a963bcd2f81e4595737fc",
  "result": {
    "markdown": "---\ntitle: \"Worst Drivers\"\nauthor: \"Karol Orozco\"\nimage: \"drivers.png\"\ndate: \"2023-03-18\"\noutput: html_document\nparams:\n  state: \"Oregon\"\n---\n\n\n\n\n\n#### States with the Most drivers Involved in Fatal Collisions per 100m Vehicle Miles\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nworst_drivers <- bad_drivers %>%\n  arrange(desc(fatalities)) %>%\n  mutate(Rank = row_number())\n\nstate_row <- worst_drivers %>%\n  filter(state == params$state) %>%\n  pull(Rank)\n\nworst_drivers %>%  \n  filter(Rank %in% 1:5 | state == params$state) %>%\n  mutate_at(.vars = vars(insuredDrivers.), .funs = ~scales::percent(. / 100)) %>%  \n  select(Rank, State = \"state\",'% Insured Drivers'= insuredDrivers.,`DUI Arrests per 1,000 Drivers` = DIUArrests, `Fatalities /100m Vehicle Miles` =fatalities) %>%\n\n  kable(format = \"html\", align = \"c\") %>%\n  kable_styling(full_width = FALSE, position = \"left\") %>%\n  row_spec(min(state_row, 6), color = \"lightgray\", background = \"darkblue\", bold = TRUE)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"width: auto !important; \">\n <thead>\n  <tr>\n   <th style=\"text-align:center;\"> Rank </th>\n   <th style=\"text-align:center;\"> State </th>\n   <th style=\"text-align:center;\"> % Insured Drivers </th>\n   <th style=\"text-align:center;\"> DUI Arrests per 1,000 Drivers </th>\n   <th style=\"text-align:center;\"> Fatalities /100m Vehicle Miles </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:center;\"> 1 </td>\n   <td style=\"text-align:center;\"> South Carolina </td>\n   <td style=\"text-align:center;\"> 90.6% </td>\n   <td style=\"text-align:center;\"> 3.95 </td>\n   <td style=\"text-align:center;\"> 1.83 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 2 </td>\n   <td style=\"text-align:center;\"> Mississippi </td>\n   <td style=\"text-align:center;\"> 76.3% </td>\n   <td style=\"text-align:center;\"> 2.61 </td>\n   <td style=\"text-align:center;\"> 1.63 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 3 </td>\n   <td style=\"text-align:center;\"> Arizona </td>\n   <td style=\"text-align:center;\"> 88.0% </td>\n   <td style=\"text-align:center;\"> 3.63 </td>\n   <td style=\"text-align:center;\"> 1.53 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 4 </td>\n   <td style=\"text-align:center;\"> Louisiana </td>\n   <td style=\"text-align:center;\"> 78.0% </td>\n   <td style=\"text-align:center;\"> 1.65 </td>\n   <td style=\"text-align:center;\"> 1.53 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 5 </td>\n   <td style=\"text-align:center;\"> West Virginia </td>\n   <td style=\"text-align:center;\"> 89.9% </td>\n   <td style=\"text-align:center;\"> 2.76 </td>\n   <td style=\"text-align:center;\"> 1.51 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;font-weight: bold;color: lightgray !important;background-color: darkblue !important;\"> 13 </td>\n   <td style=\"text-align:center;font-weight: bold;color: lightgray !important;background-color: darkblue !important;\"> Oregon </td>\n   <td style=\"text-align:center;font-weight: bold;color: lightgray !important;background-color: darkblue !important;\"> 87.3% </td>\n   <td style=\"text-align:center;font-weight: bold;color: lightgray !important;background-color: darkblue !important;\"> 4.68 </td>\n   <td style=\"text-align:center;font-weight: bold;color: lightgray !important;background-color: darkblue !important;\"> 1.37 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntitler <- function(title) {\n  textGrob(title, \n           x = unit(0, \"npc\"), \n           hjust = 0, \n           vjust = 0.5,\n           gp = gpar(fontsize = 20, fontfamily = \"josefin-slab\"))\n}\n\nsourcer <- function(source) {\n  grobTree(\n    textGrob(\"Source: \", \n             name = \"source1\",\n             x = unit(0, \"npc\"), \n             hjust = 0, \n             vjust = 0,\n             gp = gpar(fontsize = 15, fontfamily = \"josefin-slab\", fontface = \"bold\")),\n    textGrob(source, \n             x = unit(0, \"npc\") + grobWidth(\"source1\"), \n             hjust = 0, \n             vjust = 0,\n             gp = gpar(fontsize = 15, fontfamily = \"josefin-slab\"))\n  )\n}\n\ncaption <- grobTree(\n  gp = gpar(fontsize = 15), \n  textGrob(label = \"Karol Orozco\", \n           name = \"caption1\",\n           x = unit(0, \"npc\"),  \n           y = unit(0, \"npc\"),\n           hjust = 0, \n           vjust = 1)\n)\n\nplotr <- function(plot, title = NULL, subtitle = NULL, \n                  source = \"World Population Report\",\n                  endnote = \"\") {\n  grid.arrange(titler(title), \n              plot, \n              caption, \n              sourcer(source),\n              heights = c(1.5, 4, 1, 1)) \n\n}\n\n\nplot <- worst_drivers%>%\n select(state, DIUArrests, fatalities)%>%\n  gather(key = \"key\", value = \"value\", -state) %>%\n  filter(state == params$state) %>%\n  ggplot(aes(key, value)) +\n  geom_bar(stat = \"identity\", fill= \"darkblue\")+\n  scale_y_continuous(expand = c(0, 0), limits = c(0, 5)) +\n  labs(x= \"\", y =\" \")\n\nplotr(plot= plot,\n      title = paste0(\"Driver Behaviors in \", params$state),\n      source = \"World Population Review\")\n```\n\n::: {.cell-output-display}\n![](drivers_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "drivers_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\r\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}